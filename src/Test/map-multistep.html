<!DOCTYPE html>
<html>
<head>
  <title>Map Multi Step</title>
  <meta charset="utf-8" />
  <style> #map { height: 100vh; margin: 0; } </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
<div id="map"></div>
<script>
  let map = L.map('map').setView([-7.9557, 112.6145], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

  let step = 'pickup';
  let marker;

  map.on('click', function(e) {
  if (marker) map.removeLayer(marker);
  marker = L.marker(e.latlng).addTo(map);

  if (window.javaConnector && typeof window.javaConnector.sendCoordinates === 'function') {
    window.javaConnector.sendCoordinates(e.latlng.lat, e.latlng.lng);
  } else {
    alert('javaConnector belum tersedia!');
    console.log("Lat: " + e.latlng.lat + ", Lng: " + e.latlng.lng);
  }
});

  function switchToDestination() {
    alert("Sekarang pilih titik tujuan");
    if (marker) map.removeLayer(marker);
    step = 'destination';
  }

  window.switchToDestination = switchToDestination;
</script>
</body>
</html>